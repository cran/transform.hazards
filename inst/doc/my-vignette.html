<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Pål Ryalen" />

<meta name="date" content="2023-06-06" />

<title>transform.hazards</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">transform.hazards</h1>
<h4 class="author">Pål Ryalen</h4>
<h4 class="date">2023-06-06</h4>



<p>Transforms cumulative hazard estimates to estimate survival analysis
parameters specified by differential equations. We demonstrate how the
method works on some commonly studied parameters.</p>
<div id="parameters" class="section level2">
<h2>Parameters</h2>
<p>We are interested in assessing parameters that solve differential
equations driven by cumulative hazards <span class="math inline">\(A\)</span>, i.e. <span class="math display">\[\begin{equation}X_t = X_0 + \int_0^t F(X_s)
dA_s,\end{equation}\]</span> where <span class="math inline">\(F =
(F_1,F_2,\cdots)\)</span> is Lipschitz, two times continuously
differentiable, and satisfies a linear growth bound. Several examples of
such parameters can be found in <a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> <a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>. The main function <em>pluginEstimate</em>
in this package estimate such parameters. Among other things,
<em>pluginEstimate</em> has the following input</p>
<ul>
<li>The increments of the cumulative hazard estimates</li>
<li>The function <span class="math inline">\(F\)</span></li>
<li>The Jacobian matrices of the columns of <span class="math inline">\(F\)</span>, i.e. <span class="math inline">\(J_{F_1},J_{F_2},\cdots\)</span>, as a list</li>
</ul>
<p>We illustrate how to provide the correct inputs by use of examples
below.</p>
</div>
<div id="survival" class="section level2">
<h2>Survival</h2>
<p>The survival function <span class="math inline">\(S\)</span> solves a
differential equation with initial value 1; <span class="math display">\[\begin{equation} S_t = 1 - \int_0^t S_{s}
dA_s.\end{equation}\]</span></p>
<p>We generate a sample of exponentially distributed survival times with
independent censoring, and calculate cumulative hazard estimates</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">300</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>Samp1 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n1,<span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>cTimes <span class="ot">&lt;-</span> <span class="fu">runif</span>(n1)<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Samp1 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(Samp1,cTimes)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>isNotCensored <span class="ot">&lt;-</span> cTimes <span class="sc">!=</span> Samp1</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>startTimes1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n1)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>aaMod1 <span class="ot">&lt;-</span> <span class="fu">aalen</span>(<span class="fu">Surv</span>(startTimes1,Samp1,isNotCensored)<span class="sc">~</span><span class="dv">1</span>)</span></code></pre></div>
<p>We want to estimate the survival function. The cumulative hazard
estimates are inserted as a time-ordered matrix where each column is an
increment of the vector of cumulatie hazard estimates;</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dA_est1 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">0</span>,aaMod1<span class="sc">$</span>cum[,<span class="dv">2</span>]))</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>hazMatrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(dA_est1,<span class="at">nrow=</span><span class="dv">1</span>)</span></code></pre></div>
<p>In this case, <span class="math inline">\(F\)</span> takes the simple
form <span class="math inline">\(F(x) = -x\)</span>, and its Jacobian is
therefore <span class="math inline">\(J_{F}(x) = -1\)</span>. These must
be provided as matrix-valued functions;</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>F_survival <span class="ot">&lt;-</span> <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="sc">-</span>X,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">1</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>F_survival_JacobianList <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">1</span>))</span></code></pre></div>
<p>We obtain plugin estimates of <span class="math inline">\(S\)</span>
and its covariance using the call</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">pluginEstimate</span>(n1, hazMatrix, F_survival, F_survival_JacobianList,<span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">1</span>),<span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">1</span>))</span></code></pre></div>
<p>Finally, we may plot the results with approximate 95 % confidence
intervals</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>times1 <span class="ot">&lt;-</span> aaMod1<span class="sc">$</span>cum[,<span class="dv">1</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(times1,param<span class="sc">$</span>X,<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">xlab=</span><span class="st">&quot;t&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">main=</span><span class="st">&quot;Survival&quot;</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(times1,param<span class="sc">$</span>X <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>covariance[<span class="dv">1</span>,<span class="dv">1</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(times1,param<span class="sc">$</span>X <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>covariance[<span class="dv">1</span>,<span class="dv">1</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(times1,<span class="fu">exp</span>(<span class="sc">-</span>times1),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;estimated&quot;</span>,<span class="st">&quot;true&quot;</span>),<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="restricted-mean-survival" class="section level2">
<h2>Restricted mean survival</h2>
<p>The restricted mean survival function <span class="math inline">\(R\)</span> solves the system <span class="math display">\[\begin{equation} \begin{pmatrix} S_t \\ R_t
\end{pmatrix} = \begin{pmatrix}1 \\ 0 \end{pmatrix} + \int_0^t
\begin{pmatrix} -S_{s} &amp; 0 \\ 0 &amp; S_s \end{pmatrix}d
\begin{pmatrix}A_s \\ s \end{pmatrix},\end{equation}\]</span></p>
<p>where <span class="math inline">\(S\)</span> is the survival
function. Here, the colums of <span class="math inline">\(F\)</span>,
<span class="math inline">\(F_1\)</span> and <span class="math inline">\(F_2\)</span>, are given by <span class="math display">\[\begin{equation} F_1(x_1,x_2) = \begin{pmatrix}
-x_1 \\ 0 \end{pmatrix}, F_2(x_1,x_2) = \begin{pmatrix} 0 \\ x_1
\end{pmatrix}.\end{equation}\]</span> The Jacobian matrices are
therefore <span class="math display">\[\begin{equation} J_{F_1}(x_1,x_2)
= \begin{pmatrix} -1 &amp; 0 \\ 0 &amp; 0 \end{pmatrix},
J_{F_2}(x_1,x_2) = \begin{pmatrix} 0 &amp; 0 \\ 1 &amp; 0 \end{pmatrix}.
\end{equation}\]</span> We define these along with initial values
below</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>F_restrict <span class="ot">&lt;-</span> <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span>X[<span class="dv">1</span>],<span class="dv">0</span>,<span class="dv">0</span>,X[<span class="dv">1</span>]),<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>F_restrict_JacobianList <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">nrow=</span><span class="dv">2</span>),</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                                <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">byrow=</span>T))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>X0_restrict <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>V0_restrict <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p>The restricted mean survival is a ‘regular’ (i.e. Lebesgue) integral,
and we must therefore provide the time increments. We choose the time
interval <span class="math inline">\([0,4]\)</span> in <span class="math inline">\(10^4\)</span> increments:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>fineTimes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">4</span>,<span class="at">length.out =</span> <span class="fl">1e4</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>tms <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(fineTimes,times1)))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>hazMatrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="fu">length</span>(tms))</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">1</span>,<span class="fu">match</span>(times1,tms)] <span class="ot">&lt;-</span> dA_est1</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">2</span>,] <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">0</span>,tms))</span></code></pre></div>
<p>We obtain plugin estimates using the call (note the last argument
that in this example can be used to improve efficiency);</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">pluginEstimate</span>(n1, hazMatrix, F_restrict, F_restrict_JacobianList,X0_restrict,V0_restrict,<span class="at">isLebesgue =</span> <span class="dv">2</span>)</span></code></pre></div>
<p>We plot the results</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tms,param<span class="sc">$</span>X[<span class="dv">2</span>,],<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.5</span>),<span class="at">xlab=</span><span class="st">&quot;t&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">main=</span><span class="st">&quot;Restricted mean survival&quot;</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tms,param<span class="sc">$</span>X[<span class="dv">2</span>,] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>covariance[<span class="dv">2</span>,<span class="dv">2</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tms,param<span class="sc">$</span>X[<span class="dv">2</span>,] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>covariance[<span class="dv">2</span>,<span class="dv">2</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tms,<span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>tms),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;estimated&quot;</span>,<span class="st">&quot;true&quot;</span>),<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="relative-survival" class="section level2">
<h2>Relative survival</h2>
<p>We generate another set of exponentially distributed survival times
and compare the two groups. A new matrix of cumulative hazard increments
must be created;</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Samp2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n2,<span class="fl">1.3</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>censTimes2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n2)<span class="sc">*</span><span class="dv">3</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>Samp2 <span class="ot">&lt;-</span> <span class="fu">pmin</span>(Samp2,censTimes2)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>isNotCensored2 <span class="ot">&lt;-</span> censTimes2 <span class="sc">!=</span> Samp2</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>startTimes2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,n2)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>aaMod2 <span class="ot">&lt;-</span> <span class="fu">aalen</span>(<span class="fu">Surv</span>(startTimes2,Samp2,isNotCensored2)<span class="sc">~</span><span class="dv">1</span>)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>dA_est2 <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">0</span>,aaMod2<span class="sc">$</span>cum[,<span class="dv">2</span>]))</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>times2 <span class="ot">&lt;-</span> aaMod2<span class="sc">$</span>cum[,<span class="dv">1</span>]</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(times1,times2)))</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>hazMatrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="fu">length</span>(times))</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">1</span>,<span class="fu">match</span>(times1,times)] <span class="ot">&lt;-</span> dA_est1</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">2</span>,<span class="fu">match</span>(times2,times)] <span class="ot">&lt;-</span> dA_est2</span></code></pre></div>
<p>The relative survival function <span class="math inline">\(RS\)</span> between groups 1 and 2 solve the
equation <span class="math display">\[\begin{equation} RS_t = 1 +
\int_0^t \begin{pmatrix} -RS_s &amp; RS_s\end{pmatrix} d\begin{pmatrix}
A_s^1 \\ A_s^2 \end{pmatrix}, \end{equation}\]</span></p>
<p>i.e. <span class="math inline">\(F(x) = (-x,x)\)</span>. The
Jacobians of the columns of <span class="math inline">\(F\)</span> are
<span class="math inline">\(J_{F_1}(x) = -1\)</span>, and <span class="math inline">\(J_{F_2}(x) = 1\)</span>. We specify these
functions as follows:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>F_relsurv <span class="ot">&lt;-</span> <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span>X,X),<span class="at">nrow=</span><span class="dv">1</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>F_relsurv_JacobianList <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="at">nrow=</span><span class="dv">1</span>),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                               <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow=</span><span class="dv">1</span>))</span></code></pre></div>
<p>The estimates are then obtained by the call</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">pluginEstimate</span>(n1<span class="sc">+</span>n2, hazMatrix, F_relsurv, F_relsurv_JacobianList,<span class="fu">matrix</span>(<span class="dv">1</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">1</span>),<span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">1</span>,<span class="at">ncol=</span><span class="dv">1</span>))</span></code></pre></div>
<p>We may plot the results with approximate 95% confidence intervals</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(times,param<span class="sc">$</span>X,<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">4</span>),<span class="at">xlab=</span><span class="st">&quot;t&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">main=</span><span class="st">&quot;Relative survival&quot;</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(times,param<span class="sc">$</span>X <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>covariance[<span class="dv">1</span>,<span class="dv">1</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(times,param<span class="sc">$</span>X <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>covariance[<span class="dv">1</span>,<span class="dv">1</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(times,<span class="fu">exp</span>(<span class="sc">-</span>times<span class="sc">*</span>(<span class="dv">1</span><span class="sc">/</span><span class="fl">1.3</span> <span class="sc">-</span> <span class="dv">1</span>)),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;estimated&quot;</span>,<span class="st">&quot;true&quot;</span>),<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="cumulative-incidence" class="section level2">
<h2>Cumulative incidence</h2>
<p>We may be in a situation with two competing risks. The cumulative
incidences <span class="math inline">\(C^1,C^2\)</span> solve the system
<span class="math display">\[\begin{equation} \begin{pmatrix} S_t \\
C_t^1 \\ C_t^2 \end{pmatrix} = \begin{pmatrix} 1 \\ 0 \\ 0 \end{pmatrix}
+ \int_0^t \begin{pmatrix} -S_s &amp; -S_s \\ S_s &amp; 0 \\ 0 &amp; S_s
\end{pmatrix} d \begin{pmatrix} A^1_s \\ A^2_s \end{pmatrix},
\end{equation}\]</span> where <span class="math inline">\(S\)</span> is
the survival. The first columns of <span class="math inline">\(F\)</span> are</p>
<p><span class="math display">\[\begin{equation}F_1(x_1,x_2,x_2) =
\begin{pmatrix} -x_1 \\ x_1 \\ 0 \end{pmatrix},  F_2(x_1,x_2,x_2) =
\begin{pmatrix} -x_1 \\ 0 \\ x_1 \end{pmatrix}
\end{equation}\]</span></p>
<p>The reader may verify that the Jacobian matrix of <span class="math inline">\(F_1\)</span> and <span class="math inline">\(F_1\)</span> are <span class="math display">\[\begin{equation} J_{F_1}(x_1,x_2,x_3) =
\begin{pmatrix} -1 &amp; 0 &amp; 0 \\ 1 &amp; 0 &amp; 0 \\ 0 &amp; 0
&amp; 0 \end{pmatrix} , J_{F_2}(x_1,x_2,x_3) = \begin{pmatrix} -1 &amp;
0 &amp; 0 \\ 0 &amp; 0 &amp; 0 \\ 1 &amp; 0 &amp; 0 \end{pmatrix}
\end{equation}\]</span></p>
<p>We specify the function <span class="math inline">\(F\)</span> and
the list of the Jacobian matrices below, along with the initial
values:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>F_cuminc <span class="ot">&lt;-</span> <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span>X[<span class="dv">1</span>],<span class="sc">-</span>X[<span class="dv">1</span>],X[<span class="dv">1</span>],<span class="dv">0</span>,<span class="dv">0</span>,X[<span class="dv">1</span>]),<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span>T)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>F_cuminc_JacobianList <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span>T),</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                               <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">byrow=</span>T))</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>X0_cuminc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>v0_cuminc <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">3</span>)</span></code></pre></div>
<p>Now for obtaining hazard estimates. We generate survival times first,
before sampling two causes of death (and censoring). We then estimate
the cause-specific cumulative hazards, and transform the estimates:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the data</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>dfr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">from=</span><span class="dv">0</span>,<span class="at">to=</span><span class="fu">rexp</span>(n1<span class="sc">+</span>n2,<span class="dv">1</span>),<span class="at">from.state =</span> <span class="dv">1</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding causes of death (to.state = 2 or 3) and censoring (to.state = 0)</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>dfr<span class="sc">$</span>to.state <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">3</span>),n1<span class="sc">+</span>n2,<span class="at">replace=</span>T,<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.6</span>))</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtaining cause-specific cumulative hazard estimates and extracting the increments</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>aamod22 <span class="ot">&lt;-</span> <span class="fu">aalen</span>(<span class="fu">Surv</span>(from,to,to.state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2</span>)) <span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>dfr)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>aamod33 <span class="ot">&lt;-</span> <span class="fu">aalen</span>(<span class="fu">Surv</span>(from,to,to.state <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">3</span>)) <span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>dfr)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>tmss <span class="ot">=</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(aamod22<span class="sc">$</span>cum[,<span class="dv">1</span>],aamod33<span class="sc">$</span>cum[,<span class="dv">1</span>])))</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>hazMatrix <span class="ot">=</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">2</span>,<span class="at">ncol=</span><span class="fu">length</span>(tmss))</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>mt1 <span class="ot">=</span> <span class="fu">match</span>(aamod22<span class="sc">$</span>cum[,<span class="dv">1</span>],tmss)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>mt2 <span class="ot">=</span> <span class="fu">match</span>(aamod33<span class="sc">$</span>cum[,<span class="dv">1</span>],tmss)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">1</span>,mt1] <span class="ot">=</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">0</span>, aamod22<span class="sc">$</span>cum[,<span class="dv">2</span>] ))</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">2</span>,mt2] <span class="ot">=</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">0</span>, aamod33<span class="sc">$</span>cum[,<span class="dv">2</span>] ))</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Transforming the estimates</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>param <span class="ot">&lt;-</span> <span class="fu">pluginEstimate</span>(n1<span class="sc">+</span>n2,hazMatrix,F_cuminc,F_cuminc_JacobianList,X0_cuminc,v0_cuminc)</span></code></pre></div>
<p>Finally, we plot the estimates of the cumulative incidences <span class="math inline">\(C^1\)</span> and <span class="math inline">\(C^2\)</span> with confidence intervals:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tmss,param<span class="sc">$</span>X[<span class="dv">2</span>,],<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">4</span>),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">xlab=</span><span class="st">&quot;t&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">main=</span><span class="st">&quot;Cumulative incidence&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmss,param<span class="sc">$</span>X[<span class="dv">2</span>,] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>covariance[<span class="dv">2</span>,<span class="dv">2</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmss,param<span class="sc">$</span>X[<span class="dv">2</span>,] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>covariance[<span class="dv">2</span>,<span class="dv">2</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmss,param<span class="sc">$</span>X[<span class="dv">3</span>,],<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmss,param<span class="sc">$</span>X[<span class="dv">3</span>,] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>covariance[<span class="dv">3</span>,<span class="dv">3</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(tmss,param<span class="sc">$</span>X[<span class="dv">3</span>,] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>covariance[<span class="dv">3</span>,<span class="dv">3</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="fu">c</span>(<span class="fu">expression</span>(C<span class="sc">^</span><span class="dv">1</span>),<span class="fu">expression</span>(C<span class="sc">^</span><span class="dv">2</span>)),<span class="at">lty=</span><span class="dv">1</span>,<span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>),<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="restricted-mean-survival-comparing-two-groups" class="section level2">
<h2>Restricted mean survival – comparing two groups</h2>
<p>By re-specifying the ODE system we can compare two groups. We
illustrate this in the restricted mean survival example. Consider the
system</p>
<p><span class="math display">\[\begin{equation} \begin{pmatrix} R_t^1
\\ R^2 \\ RD \\ S^1 \\ S^2 \end{pmatrix} = \begin{pmatrix} 0 \\ 0 \\ 0
\\ 1 \\ 1 \end{pmatrix} + \int_0^t \begin{pmatrix} S^1_{s} &amp; 0 &amp;
0 \\ S^2_{s} &amp; 0 &amp; 0 \\ S^1_{s} - S^2_{s} &amp; 0 &amp; 0 \\ 0
&amp; -S_s^1 &amp; 0 \\ 0 &amp; 0 &amp; -S_s^2 \end{pmatrix}d
\begin{pmatrix}s \\ A_s^1 \\ A_s^2
\end{pmatrix},\end{equation}\]</span></p>
<p>where <span class="math inline">\(S^i\)</span> is the survival
function in group <span class="math inline">\(i\)</span>.
<!-- Here, the colums of $F$, $F_1$ and $F_2$, are given by -->
<!-- \begin{equation} F_1(x_1,x_2) = \begin{pmatrix} -x_1 \\ 0 \end{pmatrix}, F_2(x_1,x_2) = \begin{pmatrix} 0 \\ x_1 \end{pmatrix}.\end{equation} -->
<!-- The Jacobian matrices are therefore -->
<!-- \begin{equation} J_{F_1}(x_1,x_2) = \begin{pmatrix} -1 & 0 \\ 0 & 0 \end{pmatrix}, J_{F_2}(x_1,x_2) = \begin{pmatrix} 0 & 0 \\ 1 & 0 \end{pmatrix}. \end{equation} -->
We specify matrix-valued functions and initial values as before:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>F_restrict_diff <span class="ot">&lt;-</span> <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(X[<span class="dv">4</span>],<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>                                       X[<span class="dv">5</span>],<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                                       X[<span class="dv">4</span>]<span class="sc">-</span>X[<span class="dv">5</span>],<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                                       <span class="dv">0</span>,<span class="sc">-</span>X[<span class="dv">4</span>],<span class="dv">0</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                                       <span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span>X[<span class="dv">5</span>]),<span class="at">nrow=</span><span class="dv">5</span>,<span class="at">byrow=</span>T)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>F_restrict_diff_JacobianList <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                                                         <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>                                                         <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">10</span>)),<span class="at">nrow=</span><span class="dv">5</span>,<span class="at">byrow=</span>T),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                                     <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">18</span>),<span class="sc">-</span><span class="dv">1</span>,<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>)),<span class="at">nrow=</span><span class="dv">5</span>,<span class="at">byrow=</span>T),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                                     <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">24</span>),<span class="sc">-</span><span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">5</span>,<span class="at">byrow=</span>T))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>X0_restrict_diff <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>),<span class="at">nrow=</span><span class="dv">5</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>V0_restrict_diff <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">5</span>,<span class="at">ncol=</span><span class="dv">5</span>)</span></code></pre></div>
<p>We compare RMS for males and females in the <em>flchain</em> data set
in the <em>survival</em> package. Specifying <em>hazmatrix</em>:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>aa_male <span class="ot">=</span> <span class="fu">aalen</span>(<span class="fu">Surv</span>(futime,death<span class="sc">==</span><span class="dv">1</span>)<span class="sc">~</span><span class="dv">1</span>, <span class="at">data =</span> flchain[flchain<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;M&quot;</span>,]) </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>aa_female <span class="ot">=</span> <span class="fu">aalen</span>(<span class="fu">Surv</span>(futime,death<span class="sc">==</span><span class="dv">1</span>)<span class="sc">~</span><span class="dv">1</span>, <span class="at">data =</span> flchain[flchain<span class="sc">$</span>sex<span class="sc">==</span><span class="st">&quot;F&quot;</span>,]) </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>tms <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(fineTimes,aa_male<span class="sc">$</span>cum[,<span class="dv">1</span>], aa_female<span class="sc">$</span>cum[,<span class="dv">1</span>])))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>mt_male <span class="ot">=</span> <span class="fu">match</span>(aa_male<span class="sc">$</span>cum[,<span class="dv">1</span>],tms)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>mt_female <span class="ot">=</span> <span class="fu">match</span>(aa_female<span class="sc">$</span>cum[,<span class="dv">1</span>],tms)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>hazMatrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">3</span>,<span class="at">ncol=</span><span class="fu">length</span>(tms))</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">1</span>,] <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">0</span>,tms))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">2</span>,mt_male] <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">0</span>,aa_male<span class="sc">$</span>cum[,<span class="dv">2</span>]))</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">3</span>,mt_female] <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">0</span>,aa_female<span class="sc">$</span>cum[,<span class="dv">2</span>]))</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>plugEst <span class="ot">&lt;-</span> <span class="fu">pluginEstimate</span>(<span class="dv">1</span>, hazMatrix, F_restrict_diff, F_restrict_diff_JacobianList,X0_restrict_diff,V0_restrict_diff,<span class="at">isLebesgue =</span> <span class="dv">1</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>param <span class="ot">=</span> <span class="fu">list</span>(<span class="at">plugEst=</span>plugEst, <span class="at">tms=</span>tms)</span></code></pre></div>
<p>Plotting <span class="math inline">\(\hat{RD} = \hat R^1 - \hat
R^2\)</span> with 95% confidence intervals:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ylims <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.1</span><span class="sc">*</span><span class="fu">min</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">3</span>,] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">3</span>,<span class="dv">3</span>,])),</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>          <span class="fl">1.1</span><span class="sc">*</span><span class="fu">max</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">3</span>,] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">3</span>,<span class="dv">3</span>,])))</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(param<span class="sc">$</span>tms,param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">3</span>,],<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">ylim=</span>ylims,<span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">main=</span><span class="st">&quot;RMS difference&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;years&quot;</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms,param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">3</span>,] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">3</span>,<span class="dv">3</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms,param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">3</span>,] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">3</span>,<span class="dv">3</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="cumulative-incidence-comparing-two-groups" class="section level2">
<h2>Cumulative incidence – comparing two groups</h2>
<p>Consider a similar example with differences of cumulative incidence
functions</p>
<p><span class="math display">\[\begin{equation} \begin{pmatrix} S^a_t
\\ S_t^b \\ C_t^{a,1} \\ C_t^{a,2} \\ C_t^{b,1} \\ C_t^{b,2} \\ CD_t^1
\\ CD_t^2 \end{pmatrix} = \begin{pmatrix} 1 \\ 1 \\ 0 \\ 0 \\ 0 \\ 0 \\
0 \\ 0 \end{pmatrix} + \int_0^t \begin{pmatrix} -S_s^a &amp; -S_s^a
&amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; -S_s^b &amp; -S_s^b \\ S_s^a &amp; 0
&amp; 0 &amp; 0 \\ 0 &amp; S_s^a &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp;
S_s^b  &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; S_s^b \\ S_s^a &amp; 0 &amp;
-S_s^b &amp; 0 \\ 0 &amp; S_s^a &amp; 0 &amp; -S_s^b  \end{pmatrix} d
\begin{pmatrix} A^{a,1}_s \\ A^{a,2}_s \\ A^{b,1}_s \\ A^{b,2}_s
\end{pmatrix}, \end{equation}\]</span> where <span class="math inline">\(S^a\)</span> is the survival in group <span class="math inline">\(a\)</span> and <span class="math inline">\(S^b\)</span> is the survival in group <span class="math inline">\(b\)</span>, and <span class="math inline">\(C^{a,j}\)</span> is the cumulative incidence for
cause <span class="math inline">\(j\)</span> in group <span class="math inline">\(a\)</span> and similarly for group <span class="math inline">\(b\)</span>. <span class="math inline">\(CD^i =
C^{a,i} - C^{b,i}\)</span> is the cumulative incidence difference for
cause <span class="math inline">\(i\)</span>. We specify the ODE
system.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>F_cuminc_diff <span class="ot">&lt;-</span> <span class="cf">function</span>(X)<span class="fu">matrix</span>( <span class="fu">c</span>(<span class="sc">-</span>X[<span class="dv">1</span>],<span class="sc">-</span>X[<span class="dv">1</span>],<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>                                      <span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span>X[<span class="dv">2</span>],<span class="sc">-</span>X[<span class="dv">2</span>],</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                                      X[<span class="dv">1</span>],<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>                                      <span class="dv">0</span>,X[<span class="dv">1</span>],<span class="dv">0</span>,<span class="dv">0</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                                      <span class="dv">0</span>,<span class="dv">0</span>,X[<span class="dv">2</span>],<span class="dv">0</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>                                      <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,X[<span class="dv">2</span>],</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                                      X[<span class="dv">1</span>],<span class="dv">0</span>,<span class="sc">-</span>X[<span class="dv">2</span>],<span class="dv">0</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                                      <span class="dv">0</span>,X[<span class="dv">1</span>],<span class="dv">0</span>,<span class="sc">-</span>X[<span class="dv">2</span>]) ,<span class="at">nrow=</span><span class="dv">8</span>,<span class="at">byrow=</span>T)</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>F_cuminc_diff_JacobianList <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">7</span>),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                                                       <span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">7</span>),</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                                                       <span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">7</span>),</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>)),<span class="at">nrow=</span><span class="dv">8</span>,<span class="at">byrow=</span>T),</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">7</span>),</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>                                                       <span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">7</span>),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>                                                       <span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">7</span>)),<span class="at">nrow=</span><span class="dv">8</span>,<span class="at">byrow=</span>T),</span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>                                                       <span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>                                                       <span class="dv">0</span>,<span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),</span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>                                                       <span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),</span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>)),<span class="at">nrow=</span><span class="dv">8</span>,<span class="at">byrow=</span>T),</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">function</span>(X)<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>                                                       <span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>                                                       <span class="dv">0</span>,<span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>),</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>                                                       <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">8</span>),</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>                                                       <span class="dv">0</span>,<span class="sc">-</span><span class="dv">1</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">6</span>)),<span class="at">nrow=</span><span class="dv">8</span>,<span class="at">byrow=</span>T))</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>X0_cuminc_diff <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),<span class="at">nrow=</span><span class="dv">8</span>)</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>v0_cuminc_diff <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">8</span>,<span class="at">ncol=</span><span class="dv">8</span>)</span></code></pre></div>
<p>We inspect cumulative incidences of the competing events PCM, and
death without malignancy, in the <em>mgus2</em> data set. We compare
males and females in this data set. Specifying <em>hazmatrix</em>:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mgus2<span class="sc">$</span>etime <span class="ot">&lt;-</span> <span class="fu">with</span>(mgus2, <span class="fu">ifelse</span>(pstat<span class="sc">==</span><span class="dv">0</span>, futime, ptime))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>event <span class="ot">&lt;-</span> <span class="fu">with</span>(mgus2, <span class="fu">ifelse</span>(pstat<span class="sc">==</span><span class="dv">0</span>, <span class="dv">2</span><span class="sc">*</span>death, <span class="dv">1</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>mgus2<span class="sc">$</span>event <span class="ot">&lt;-</span> <span class="fu">factor</span>(event, <span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;censor&quot;</span>, <span class="st">&quot;pcm&quot;</span>, <span class="st">&quot;death&quot;</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>fr_M <span class="ot">&lt;-</span> mgus2[mgus2<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;M&quot;</span>,]</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>fr_M<span class="sc">$</span>time <span class="ot">&lt;-</span> fr_M<span class="sc">$</span>etime<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>fr_F <span class="ot">&lt;-</span> mgus2[mgus2<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">&quot;F&quot;</span>,]</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>fr_F<span class="sc">$</span>time <span class="ot">&lt;-</span> fr_F<span class="sc">$</span>etime<span class="sc">/</span><span class="dv">12</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>fit_PCM_M <span class="ot">=</span> <span class="fu">aalen</span>(<span class="fu">Surv</span>(time,event<span class="sc">==</span><span class="st">&quot;pcm&quot;</span>)<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>fr_M)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>fit_death_M <span class="ot">=</span> <span class="fu">aalen</span>(<span class="fu">Surv</span>(time,event<span class="sc">==</span><span class="st">&quot;death&quot;</span>)<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>fr_M)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>fit_PCM_F <span class="ot">=</span> <span class="fu">aalen</span>(<span class="fu">Surv</span>(time,event<span class="sc">==</span><span class="st">&quot;pcm&quot;</span>)<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>fr_F)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>fit_death_F <span class="ot">=</span> <span class="fu">aalen</span>(<span class="fu">Surv</span>(time,event<span class="sc">==</span><span class="st">&quot;death&quot;</span>)<span class="sc">~</span><span class="dv">1</span>,<span class="at">data=</span>fr_F)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>tms2 <span class="ot">=</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">c</span>(fit_PCM_M<span class="sc">$</span>cum[,<span class="dv">1</span>],fit_PCM_F<span class="sc">$</span>cum[,<span class="dv">1</span>],</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>                     fit_death_M<span class="sc">$</span>cum[,<span class="dv">1</span>],fit_death_F<span class="sc">$</span>cum[,<span class="dv">1</span>])))</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>dA_PCM_M <span class="ot">=</span> dA_death_M <span class="ot">=</span> dA_PCM_F <span class="ot">=</span> dA_death_F <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(tms2))</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>dA_PCM_M[<span class="fu">match</span>(fit_PCM_M<span class="sc">$</span>cum[,<span class="dv">1</span>], tms2)] <span class="ot">=</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">0</span>,fit_PCM_M<span class="sc">$</span>cum[,<span class="dv">2</span>]))</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>dA_PCM_F[<span class="fu">match</span>(fit_PCM_F<span class="sc">$</span>cum[,<span class="dv">1</span>], tms2)] <span class="ot">=</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">0</span>,fit_PCM_F<span class="sc">$</span>cum[,<span class="dv">2</span>]))</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>dA_death_M[<span class="fu">match</span>(fit_death_M<span class="sc">$</span>cum[,<span class="dv">1</span>], tms2)] <span class="ot">=</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">0</span>,fit_death_M<span class="sc">$</span>cum[,<span class="dv">2</span>]))</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>dA_death_F[<span class="fu">match</span>(fit_death_F<span class="sc">$</span>cum[,<span class="dv">1</span>], tms2)] <span class="ot">=</span> <span class="fu">diff</span>(<span class="fu">c</span>(<span class="dv">0</span>,fit_death_F<span class="sc">$</span>cum[,<span class="dv">2</span>]))</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>hazMatrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow=</span><span class="dv">4</span>,<span class="at">ncol=</span><span class="fu">length</span>(tms2))</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">1</span>,] <span class="ot">&lt;-</span> dA_PCM_M</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">2</span>,] <span class="ot">&lt;-</span> dA_death_M</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">3</span>,] <span class="ot">&lt;-</span> dA_PCM_F</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>hazMatrix[<span class="dv">4</span>,] <span class="ot">&lt;-</span> dA_death_F</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>plugEst <span class="ot">&lt;-</span> <span class="fu">pluginEstimate</span>(<span class="dv">1</span>, hazMatrix, F_cuminc_diff, F_cuminc_diff_JacobianList,X0_cuminc_diff,v0_cuminc_diff)</span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>param <span class="ot">=</span> <span class="fu">list</span>(<span class="at">plugEst=</span>plugEst, <span class="at">tms=</span>tms2)</span></code></pre></div>
<p>Plotting <span class="math inline">\(\hat{CD}^1\)</span> and <span class="math inline">\(\hat{CD}^2\)</span> with 95% confidence
intervals:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Colors</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>male_color <span class="ot">&lt;-</span> <span class="st">&quot;red&quot;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>female_color <span class="ot">&lt;-</span> <span class="st">&quot;blue&quot;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>diff_color <span class="ot">&lt;-</span> <span class="st">&quot;gray&quot;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with colors and labels</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">3</span>,],<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>,<span class="fl">0.9</span>),<span class="at">main=</span><span class="st">&quot;Cum.inc. PCM&quot;</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Years&quot;</span>, <span class="at">col=</span>male_color)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">3</span>,] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">3</span>,<span class="dv">3</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span>male_color)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">3</span>,] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">3</span>,<span class="dv">3</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span>male_color)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">5</span>,],<span class="at">type=</span><span class="st">&quot;s&quot;</span>, <span class="at">col=</span>female_color)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">5</span>,] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">5</span>,<span class="dv">5</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span>female_color)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">5</span>,] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">5</span>,<span class="dv">5</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span>female_color)</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">7</span>,],<span class="at">type=</span><span class="st">&quot;s&quot;</span>, <span class="at">col=</span>diff_color)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">7</span>,] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">7</span>,<span class="dv">7</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span>diff_color)</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">7</span>,] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">7</span>,<span class="dv">7</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span>diff_color)</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Males&quot;</span>, <span class="st">&quot;Females&quot;</span>, <span class="st">&quot;Difference&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(male_color, female_color, diff_color), <span class="at">lty =</span> <span class="dv">1</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with colors and labels</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">4</span>,],<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.2</span>,<span class="fl">0.9</span>),<span class="at">main=</span><span class="st">&quot;Cum.inc. death&quot;</span>,</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">&quot;&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Years&quot;</span>, <span class="at">col=</span>male_color)</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">4</span>,] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">4</span>,<span class="dv">4</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span>male_color)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">4</span>,] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">4</span>,<span class="dv">4</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span>male_color)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">6</span>,],<span class="at">type=</span><span class="st">&quot;s&quot;</span>, <span class="at">col=</span>female_color)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">6</span>,] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">6</span>,<span class="dv">6</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span>female_color)</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">6</span>,] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">6</span>,<span class="dv">6</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span>female_color)</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">8</span>,],<span class="at">type=</span><span class="st">&quot;s&quot;</span>, <span class="at">col=</span>diff_color)</span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">8</span>,] <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">8</span>,<span class="dv">8</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span>diff_color)</span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(param<span class="sc">$</span>tms, param<span class="sc">$</span>plugEst<span class="sc">$</span>X[<span class="dv">8</span>,] <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> <span class="fu">sqrt</span>(param<span class="sc">$</span>plugEst<span class="sc">$</span>covariance[<span class="dv">8</span>,<span class="dv">8</span>,]),<span class="at">type=</span><span class="st">&quot;s&quot;</span>,<span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span>diff_color)</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">0</span>,<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend</span></span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Males&quot;</span>, <span class="st">&quot;Females&quot;</span>, <span class="st">&quot;Difference&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(male_color, female_color, diff_color), <span class="at">lty =</span> <span class="dv">1</span>,<span class="at">bty=</span><span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>[Transforming cumulative hazard estimates] (Biometrika,
2018).<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>[On null hypothesis in survival analysis] (Biometrics,
2019)<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
